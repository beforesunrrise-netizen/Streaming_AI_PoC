"""
Stock name to code mapping for common Korean stocks
This is a fallback when Daum Finance search is unavailable
"""

# KOSPI major stocks mapping
STOCK_MAPPING = {
    # ========== 삼성 그룹 ==========
    "삼성전자": "005930",
    "삼성": "005930",  # Default to 삼성전자
    "삼성전자우": "005935",
    "삼성SDI": "006400",
    "삼성물산": "028260",
    "삼성생명": "032830",
    "삼성화재": "000810",
    "삼성중공업": "010140",
    "삼성엔지니어링": "028050",
    "삼성바이오로직스": "207940",
    "삼성전기": "009150",
    "삼성SDS": "018260",
    "삼성카드": "029780",
    "삼성증권": "016360",
    "삼성에스디에스": "018260",
    "제일모직": "028260",

    # ========== SK 그룹 ==========
    "SK하이닉스": "000660",
    "하이닉스": "000660",
    "SK": "034730",
    "SK이노베이션": "096770",
    "SK텔레콤": "017670",
    "SK케미칼": "285130",
    "SKC": "011790",
    "SK네트웍스": "001740",
    "SK바이오팜": "326030",
    "SK바이오사이언스": "302440",
    "SK스퀘어": "402340",
    "SK아이이테크놀로지": "361610",
    "SK에코플랜트": "028050",

    # ========== 현대 그룹 ==========
    "현대차": "005380",
    "현대자동차": "005380",
    "현대차2우B": "005387",
    "현대모비스": "012330",
    "기아": "000270",
    "기아차": "000270",
    "현대중공업": "009540",
    "현대건설": "000720",
    "현대제철": "004020",
    "현대미포조선": "010620",
    "현대글로비스": "086280",
    "현대위아": "011210",
    "현대로템": "064350",
    "현대백화점": "069960",
    "현대리바트": "079430",

    # ========== LG 그룹 ==========
    "LG전자": "066570",
    "LG화학": "051910",
    "LG에너지솔루션": "373220",
    "LG": "003550",
    "LG생활건강": "051900",
    "LG디스플레이": "034220",
    "LG유플러스": "032640",
    "LG이노텍": "011070",
    "LG하우시스": "108670",
    "LGH&H": "051900",

    # ========== 포스코 그룹 ==========
    "포스코": "005490",
    "포스코홀딩스": "005490",
    "포스코퓨처엠": "003670",
    "포스코케미칼": "003670",
    "포스코DX": "022100",
    "포스코인터내셔널": "047050",

    # ========== IT/플랫폼 ==========
    "네이버": "035420",
    "NAVER": "035420",
    "카카오": "035720",
    "카카오뱅크": "323410",
    "카카오페이": "377300",
    "카카오게임즈": "293490",
    "엔씨소프트": "036570",
    "넷마블": "251270",
    "크래프톤": "259960",
    "펄어비스": "263750",
    "컴투스": "078340",

    # ========== 금융 - 은행 ==========
    "KB금융": "105560",
    "신한지주": "055550",
    "하나금융지주": "086790",
    "우리금융": "316140",
    "JB금융지주": "175330",
    "BNK금융지주": "138930",
    "DGB금융지주": "139130",

    # ========== 금융 - 증권 ==========
    "NH투자증권": "005940",
    "키움증권": "039490",
    "미래에셋증권": "006800",
    "삼성증권": "016360",
    "한국투자증권": "030200",
    "메리츠증권": "008560",
    "KB증권": "218410",
    "신한투자증권": "001720",
    "하이투자증권": "001840",

    # ========== 금융 - 보험 ==========
    "삼성화재": "000810",
    "삼성생명": "032830",
    "한화생명": "088350",
    "DB손해보험": "005830",
    "메리츠화재": "000060",
    "현대해상": "001450",

    # ========== 통신 ==========
    "KT": "030200",
    "SK텔레콤": "017670",
    "LG유플러스": "032640",
    "KT&G": "033780",

    # ========== 항공/운송 ==========
    "대한항공": "003490",
    "아시아나항공": "020560",
    "한진칼": "180640",
    "CJ대한통운": "000120",
    "팬오션": "028670",

    # ========== 유통/서비스 ==========
    "롯데쇼핑": "023530",
    "신세계": "004170",
    "현대백화점": "069960",
    "롯데하이마트": "071840",
    "BGF리테일": "027410",
    "이마트": "139480",
    "GS리테일": "007070",
    "CU": "027410",

    # ========== 식품 ==========
    "CJ제일제당": "097950",
    "오뚜기": "007310",
    "대상": "001680",
    "농심": "004370",
    "삼양식품": "003230",
    "풀무원": "017810",
    "SPC삼립": "005610",
    "롯데제과": "280360",
    "오리온": "271560",
    "하이트진로": "000080",

    # ========== 제약/바이오 ==========
    "셀트리온": "068270",
    "셀트리온헬스케어": "091990",
    "삼성바이오로직스": "207940",
    "한미약품": "128940",
    "유한양행": "000100",
    "녹십자": "006280",
    "종근당": "185750",
    "대웅제약": "069620",
    "동아에스티": "170900",
    "JW중외제약": "001060",
    "HLB": "028300",
    "신라젠": "215600",
    "바이넥스": "075970",

    # ========== 화학/정유 ==========
    "LG화학": "051910",
    "SK이노베이션": "096770",
    "SK케미칼": "285130",
    "한화솔루션": "009830",
    "롯데케미칼": "011170",
    "금호석유": "011780",
    "OCI": "010060",
    "효성": "004800",
    "효성티앤씨": "298020",
    "효성첨단소재": "298050",
    "에쓰오일": "010950",
    "GS": "078930",
    "한화": "000880",

    # ========== 건설 ==========
    "현대건설": "000720",
    "삼성물산": "028260",
    "GS건설": "006360",
    "대림산업": "000210",
    "대우건설": "047040",
    "현대엔지니어링": "028050",
    "삼성엔지니어링": "028050",
    "포스코건설": "047050",

    # ========== 철강/금속 ==========
    "포스코": "005490",
    "현대제철": "004020",
    "동국제강": "001230",
    "고려아연": "010130",
    "영풍": "000670",

    # ========== 조선 ==========
    "현대중공업": "009540",
    "삼성중공업": "010140",
    "현대미포조선": "010620",
    "대우조선해양": "042660",
    "한화오션": "042660",

    # ========== 전기/전자 ==========
    "삼성전자": "005930",
    "LG전자": "066570",
    "삼성전기": "009150",
    "LG이노텍": "011070",
    "삼성SDI": "006400",
    "LG디스플레이": "034220",

    # ========== 반도체/디스플레이 ==========
    "SK하이닉스": "000660",
    "삼성전자": "005930",
    "LG디스플레이": "034220",
    "SK실트론": "222800",
    "DB하이텍": "000990",

    # ========== 2차전지 ==========
    "LG에너지솔루션": "373220",
    "삼성SDI": "006400",
    "포스코퓨처엠": "003670",
    "에코프로비엠": "247540",
    "에코프로": "086520",
    "엘앤에프": "066970",
    "천보": "278280",

    # ========== 자동차/부품 ==========
    "현대차": "005380",
    "기아": "000270",
    "현대모비스": "012330",
    "현대위아": "011210",
    "만도": "204320",
    "현대트랜시스": "152100",
    "현대글로비스": "086280",

    # ========== 엔터테인먼트 ==========
    "하이브": "352820",
    "HYBE": "352820",
    "JYP": "035900",
    "SM": "041510",
    "YG엔터테인먼트": "122870",
    "YG": "122870",
    "YGPLUS": "037270",
    "CJ ENM": "035760",
    "스튜디오드래곤": "253450",
    "키이스트": "054780",

    # ========== 에너지/전력 ==========
    "한국전력": "015760",
    "한전KPS": "051600",
    "한국가스공사": "036460",
    "GS": "078930",
    "S-Oil": "010950",
    "에쓰오일": "010950",

    # ========== 기타 주요 기업 ==========
    "CJ": "001040",
    "두산": "000150",
    "두산밥캣": "241560",
    "두산에너빌리티": "034020",
    "LS": "006260",
    "코웨이": "021240",
    "아모레퍼시픽": "090430",
    "LG생활건강": "051900",
    "한화에어로스페이스": "012450",
    "KCC": "002380",
    "한샘": "009240",
}


def get_stock_code(stock_name: str) -> tuple:
    """
    Get stock code from name using mapping

    Args:
        stock_name: Korean stock name

    Returns:
        (code, name) tuple or None
    """
    # Direct match
    if stock_name in STOCK_MAPPING:
        return (STOCK_MAPPING[stock_name], stock_name)

    # Try partial match
    for name, code in STOCK_MAPPING.items():
        if stock_name in name or name in stock_name:
            return (code, name)

    return None


def get_stock_name(stock_code: str) -> str:
    """
    Get stock name from code

    Args:
        stock_code: 6-digit stock code

    Returns:
        Stock name or None
    """
    # Remove A prefix if exists
    clean_code = stock_code.replace('A', '') if stock_code.startswith('A') else stock_code

    for name, code in STOCK_MAPPING.items():
        if code == clean_code:
            return name

    return None
